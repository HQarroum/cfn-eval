AWSTemplateFormatVersion: "2010-09-09"
Description: A CloudFormation template example demonstrating how to generate random numbers.

# Resources declared by this template.
Resources:

  # Definition of the evaluation resource stack.
  EvaluationResourceStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: ../../cloudformation.yml

  # Definition of the random generator resource.
  RandomGeneratorFunction:
    Type: Custom::RandomGeneratorFunction
    Properties:
      ServiceToken: !Sub ${EvaluationResourceStack.Outputs.EvaluationResourceFunctionArn}
      Code: |
        const random = () => Math.random().toString(36).substring(7);
        return ({
          Foo: random(),
          Bar: random()
        });

# The outputs to be generated by this template.
Outputs:
  FooRandom:
    Description: The generated random string for `foo`.
    Value: !Sub foo-${RandomGeneratorFunction.Foo}
    Export:
      Name: !Sub ${AWS::StackName}-FooRandom
  BarRandom:
    Description: The generated random string for `bar`.
    Value: !Sub bar-${RandomGeneratorFunction.Bar}
    Export:
      Name: !Sub ${AWS::StackName}-BarRandom
