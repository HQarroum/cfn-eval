AWSTemplateFormatVersion: "2010-09-09"
Description: A CloudFormation template example demonstrating how to transform given parameters into a JSON string.

# Resources declared by this template.
Resources:

  # Definition of the evaluation resource stack.
  EvaluationResourceStack:
    Type: AWS::CloudFormation::Stack
    Properties:
      TemplateURL: ../../cloudformation.yml

  # Definition of the JSON transform resource.
  JsonTransformResource:
    Type: Custom::JsonTransformResource
    Properties:
      ServiceToken: !Sub ${EvaluationResourceStack.Outputs.EvaluationResourceFunctionArn}
      Container:
        Object:
          Key:
            Foo: bar
          Name:
            Bar: baz
        Array:
          - One
          - Two
          - Three
      Code: |
        return ({ string: JSON.stringify(props.Container) });

# The outputs to be generated by this template.
Outputs:
  JsonString:
    Description: The generated JSON string by the evaluation function.
    Value: !Sub ${JsonTransformResource.string}
    Export:
      Name: !Sub ${AWS::StackName}-JsonString